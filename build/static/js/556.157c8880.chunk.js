"use strict";(self.webpackChunkmadestone_frontend=self.webpackChunkmadestone_frontend||[]).push([[556],{556:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var n=t(555),r=t(43),s=t(11),i=t(689),l=(t(740),t(709),t(481)),o=t(579);function c(e){let{token:a}=e;const[t,c]=(0,r.useState)([]),[d,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)({name:"",age:8,category:"U10",centerId:"",school:"",parentPhoneNumber:"",parentEmail:"",file:null}),[p,g]=(0,r.useState)(null),[v,x]=(0,r.useState)([]),[j,b]=(0,r.useState)({}),[f,N]=(0,r.useState)("");async function y(){const e=await fetch("".concat(l.JR,"/students"),{headers:{Authorization:"Bearer "+a}});if(!e.ok)return c([]);const t=await e.json();c(t.sort((e,a)=>(e.name||"").localeCompare(a.name||"")))}if((0,r.useEffect)(()=>{y(),async function(){const e=await fetch("".concat(l.JR,"/centers"),{headers:{Authorization:"Bearer "+a}});if(!e.ok)return x([]);x(await e.json())}()},[]),p)return(0,o.jsx)("div",{className:"page",children:(0,o.jsx)(s.A,{id:p,token:a,onBack:()=>g(null),embed:!0})});return(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{children:"All Students"}),(0,o.jsx)("button",{onClick:()=>u(e=>!e),style:{marginBottom:10},className:"action-button",children:d?"Cancel":"Add Student"}),d&&(0,o.jsxs)("form",{onSubmit:async function(e){if(e.preventDefault(),!function(){const e={};(!m.name||m.name.trim().length<2)&&(e.name="Name is required");const a=Number(m.age);return(!Number.isFinite(a)||a<=0)&&(e.age="Age must be a positive number"),m.category||(e.category="Category is required"),m.parentEmail&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.parentEmail)&&(e.parentEmail="Enter a valid email"),m.parentPhoneNumber&&m.parentPhoneNumber.replace(/\D/g,"").length<7&&(e.parentPhoneNumber="Enter a valid phone number"),b(e),0===Object.keys(e).length}())return;const t=await fetch("".concat(l.JR,"/students"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a},body:JSON.stringify({name:m.name,age:Number(m.age),category:m.category,school:m.school||void 0,parentPhoneNumber:m.parentPhoneNumber||void 0,parentEmail:m.parentEmail||void 0,center:m.centerId?{id:Number(m.centerId)}:void 0})});if(!t.ok)return void alert("Failed to create student");const n=await t.json();if(m.file){const e=204800;if(m.file.size>e)console.warn("Image file too large (".concat((m.file.size/1024).toFixed(2),"KB). Maximum is 200KB"));else try{const e=new FormData;e.append("file",m.file,m.file.name);(await fetch("".concat(l.JR,"/upload/student/").concat(n.id,"/image"),{method:"POST",headers:{Authorization:"Bearer "+a},body:e})).ok||console.warn("Image upload failed for student",n.id)}catch(r){console.warn("Image upload error",r)}}h({name:"",age:8,category:"U10",centerId:"",school:"",parentPhoneNumber:"",parentEmail:"",file:null}),u(!1),y()},className:"add-form",children:[(0,o.jsx)("input",{required:!0,placeholder:"Name",value:m.name,onChange:e=>h(a=>(0,n.A)((0,n.A)({},a),{},{name:e.target.value}))}),j.name&&(0,o.jsx)("div",{className:"error",style:{color:"#b00"},children:j.name}),(0,o.jsx)("input",{required:!0,placeholder:"Age",type:"number",value:m.age,onChange:e=>h(a=>(0,n.A)((0,n.A)({},a),{},{age:e.target.value}))}),j.age&&(0,o.jsx)("div",{className:"error",style:{color:"#b00"},children:j.age}),(0,o.jsxs)("select",{value:m.category,onChange:e=>h(a=>(0,n.A)((0,n.A)({},a),{},{category:e.target.value})),children:[(0,o.jsx)("option",{value:"U6",children:"U6"}),(0,o.jsx)("option",{value:"U10",children:"U10"}),(0,o.jsx)("option",{value:"U15",children:"U15"})]}),j.category&&(0,o.jsx)("div",{className:"error",style:{color:"#b00"},children:j.category}),(0,o.jsxs)("select",{value:m.centerId,onChange:e=>h(a=>(0,n.A)((0,n.A)({},a),{},{centerId:e.target.value})),children:[(0,o.jsx)("option",{value:"",children:"Select Center"}),v.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,o.jsx)("input",{placeholder:"School",value:m.school,onChange:e=>h(a=>(0,n.A)((0,n.A)({},a),{},{school:e.target.value}))}),(0,o.jsx)("input",{placeholder:"Parent Phone Number",value:m.parentPhoneNumber,onChange:e=>h(a=>(0,n.A)((0,n.A)({},a),{},{parentPhoneNumber:e.target.value}))}),j.parentPhoneNumber&&(0,o.jsx)("div",{className:"error",style:{color:"#b00"},children:j.parentPhoneNumber}),(0,o.jsx)("input",{placeholder:"Parent Email",type:"email",value:m.parentEmail,onChange:e=>h(a=>(0,n.A)((0,n.A)({},a),{},{parentEmail:e.target.value}))}),j.parentEmail&&(0,o.jsx)("div",{className:"error",style:{color:"#b00"},children:j.parentEmail}),(0,o.jsx)("input",{type:"file",accept:"image/*",onChange:e=>h(a=>(0,n.A)((0,n.A)({},a),{},{file:e.target.files[0]||null}))}),(0,o.jsx)("button",{type:"submit",children:"Create"})]}),(0,o.jsx)("div",{style:{marginBottom:12},children:(0,o.jsx)("input",{type:"text",placeholder:"\ud83d\udd0d Search student by name...",value:f,onChange:e=>N(e.target.value),style:{padding:"8px 12px",fontSize:14,borderRadius:4,border:"1px solid #ccc",width:"100%",maxWidth:"300px"}})}),(0,o.jsx)(i.A,{items:t.filter(e=>!f.trim()||e.name.toLowerCase().includes(f.toLowerCase())),onSelect:e=>g(e.id),renderItem:e=>{var a;return(0,o.jsxs)("div",{className:"student-card clickable",onClick:()=>g(e.id),children:[(0,o.jsxs)("div",{className:"profile-header",children:[(0,o.jsx)("div",{className:"profile-avatar small",children:e.imageViewUrl||e.imageUrl||e.image&&"".concat(l.JR,"/uploads/").concat(e.image)?(0,o.jsx)("img",{src:e.imageViewUrl||e.imageUrl||"".concat(l.JR,"/uploads/").concat(e.image),alt:e.name,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%"}}):e.name.charAt(0)}),(0,o.jsx)("h3",{children:e.name})]}),(0,o.jsxs)("div",{className:"profile-info",children:[(0,o.jsxs)("span",{children:["Age: ",e.age]}),(0,o.jsxs)("span",{children:["Category: ",e.category]}),(0,o.jsxs)("span",{children:["Center: ",(null===(a=e.center)||void 0===a?void 0:a.name)||"-"]})]})]},e.id)},searchFields:["name","category","center.name"],itemsPerPage:8,className:"students-list"})]})}},689:(e,a,t)=>{t.d(a,{A:()=>s});var n=t(43),r=t(579);function s(e){let{items:a,onSelect:t,renderItem:s,searchFields:i=["name"],itemsPerPage:l=10,className:o=""}=e;const[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(1),h=a.filter(e=>i.some(a=>String(e[a]).toLowerCase().includes(c.toLowerCase()))),p=Math.ceil(h.length/l),g=(u-1)*l,v=h.slice(g,g+l),x=e=>{m(e),window.scrollTo({top:0,behavior:"smooth"})};return(0,r.jsxs)("div",{className:"searchable-list ".concat(o),children:[(0,r.jsx)("div",{className:"search-container",children:(0,r.jsx)("input",{type:"text",placeholder:"Search...",value:c,onChange:e=>{d(e.target.value),m(1)},className:"search-input"})}),(0,r.jsx)("div",{className:"list-container",children:0===v.length?(0,r.jsx)("div",{className:"no-results",children:"No results found"}):v.map(e=>s(e))}),p>1&&(0,r.jsxs)("div",{className:"pagination",children:[(0,r.jsx)("button",{onClick:()=>x(u-1),disabled:1===u,className:"pagination-button",children:"Previous"}),Array.from({length:p},(e,a)=>a+1).filter(e=>1===e||e===p||e>=u-1&&e<=u+1).map(e=>(0,r.jsxs)(n.Fragment,{children:[1!==e&&e!==u-1&&e!==u+1&&e!==p&&(0,r.jsx)("span",{className:"pagination-ellipsis",children:"..."}),(0,r.jsx)("button",{onClick:()=>x(e),className:"pagination-button ".concat(u===e?"active":""),children:e})]},e)),(0,r.jsx)("button",{onClick:()=>x(u+1),disabled:u===p,className:"pagination-button",children:"Next"})]})]})}},709:()=>{},740:()=>{}}]);
//# sourceMappingURL=556.157c8880.chunk.js.map