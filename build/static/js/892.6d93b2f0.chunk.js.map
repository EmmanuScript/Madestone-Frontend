{"version":3,"file":"static/js/892.6d93b2f0.chunk.js","mappings":"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","sources":["pages/CoachAttendanceHistory.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { API_BASE_URL } from \"../config/api\";\n\nexport default function CoachAttendanceHistory({ token, onCoachClick }) {\n  const [centers, setCenters] = useState([]);\n  const [coaches, setCoaches] = useState([]);\n  const [centerId, setCenterId] = useState(\"\");\n  const [start, setStart] = useState(\"\");\n  const [end, setEnd] = useState(\"\");\n  const [records, setRecords] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    fetchCenters();\n    fetchCoaches();\n  }, []);\n\n  async function fetchCenters() {\n    const res = await fetch(`${API_BASE_URL}/centers`, {\n      headers: { Authorization: \"Bearer \" + token },\n    });\n    const data = await res.json();\n    setCenters(data.sort((a, b) => (a.name || \"\").localeCompare(b.name || \"\")));\n  }\n\n  async function fetchCoaches() {\n    const res = await fetch(`${API_BASE_URL}/users/coaches`, {\n      headers: { Authorization: \"Bearer \" + token },\n    });\n    const data = await res.json();\n    setCoaches(data.sort((a, b) => (a.name || \"\").localeCompare(b.name || \"\")));\n  }\n\n  function daysBetween(s, e) {\n    if (!s || !e) return 0;\n    const a = new Date(s);\n    const b = new Date(e);\n    const diff = Math.ceil((b - a) / (1000 * 60 * 60 * 24)) + 1;\n    return diff;\n  }\n\n  const fetchAttendance = async () => {\n    setError(null);\n    if (!centerId) return setError(\"Select a center first\");\n    if (!start || !end) return setError(\"Start and end dates are required\");\n    const diff = daysBetween(start, end);\n    if (diff > 31)\n      return setError(\n        \"Max allowed range is 1 month. Use export for larger ranges.\"\n      );\n\n    setLoading(true);\n    try {\n      const res = await fetch(\n        `${API_BASE_URL}/coach-attendance/center/${centerId}?start=${start}&end=${end}`,\n        { headers: { Authorization: \"Bearer \" + token } }\n      );\n      if (!res.ok) throw new Error(\"Failed to fetch coach attendance\");\n      const data = await res.json();\n      setRecords(data);\n    } catch (err) {\n      setError(err.message || \"Failed to load\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const exportCenter = async () => {\n    if (!centerId) return setError(\"Select a center to export\");\n    if (!start || !end)\n      return setError(\"Start and end dates are required for export\");\n    try {\n      const res = await fetch(\n        `${API_BASE_URL}/coach-attendance/export/center/${centerId}?start=${start}&end=${end}`,\n        { headers: { Authorization: \"Bearer \" + token } }\n      );\n      if (!res.ok) throw new Error(\"Export failed\");\n      const text = await res.text();\n      const blob = new Blob([text], { type: \"text/csv\" });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `coach-attendance-center-${centerId}.csv`;\n      document.body.appendChild(a);\n      a.click();\n      a.remove();\n      window.URL.revokeObjectURL(url);\n    } catch (err) {\n      setError(err.message || \"Export failed\");\n    }\n  };\n\n  // Group records by coach\n  const groupedData = {};\n  const allDates = new Set();\n\n  records.forEach((record) => {\n    const coachId = record.coach?.id;\n    const coachName = record.coach?.name || \"Unknown\";\n    const centerName = record.coach?.center?.name || \"-\";\n    const date = record.date;\n\n    if (!groupedData[coachId]) {\n      groupedData[coachId] = {\n        id: coachId,\n        name: coachName,\n        center: centerName,\n        dates: {},\n      };\n    }\n\n    groupedData[coachId].dates[date] = record.present ? \"✓\" : \"✗\";\n    allDates.add(date);\n  });\n\n  const sortedDates = Array.from(allDates).sort();\n  const coachesData = Object.values(groupedData);\n\n  const coachesForCenter = centerId\n    ? coaches.filter((c) => c.center?.id === Number(centerId))\n    : coaches;\n\n  return (\n    <div>\n      <h3>Coach Attendance History</h3>\n\n      <div\n        style={{ display: \"flex\", gap: 8, flexWrap: \"wrap\", marginBottom: 12 }}\n      >\n        <select value={centerId} onChange={(e) => setCenterId(e.target.value)}>\n          <option value=\"\">-- Select center --</option>\n          {centers.map((c) => (\n            <option key={c.id} value={c.id}>\n              {c.name}\n            </option>\n          ))}\n        </select>\n\n        <label>\n          From\n          <input\n            type=\"date\"\n            value={start}\n            onChange={(e) => setStart(e.target.value)}\n          />\n        </label>\n        <label>\n          To\n          <input\n            type=\"date\"\n            value={end}\n            onChange={(e) => setEnd(e.target.value)}\n          />\n        </label>\n      </div>\n\n      <div style={{ display: \"flex\", gap: 8, marginBottom: 12 }}>\n        <button\n          onClick={fetchAttendance}\n          disabled={loading}\n          style={{ padding: \"8px 24px\", minWidth: \"120px\" }}\n        >\n          Fetch\n        </button>\n\n        <button\n          onClick={exportCenter}\n          style={{ padding: \"8px 24px\", minWidth: \"120px\" }}\n        >\n          Export (CSV)\n        </button>\n      </div>\n\n      {error && <div style={{ color: \"#b00\" }}>{error}</div>}\n\n      {loading && <div>Loading...</div>}\n\n      {!loading && coachesData.length > 0 && (\n        <div style={{ overflowX: \"auto\" }}>\n          <table\n            style={{\n              width: \"100%\",\n              borderCollapse: \"collapse\",\n              minWidth: \"600px\",\n            }}\n          >\n            <thead>\n              <tr>\n                <th\n                  style={{\n                    textAlign: \"left\",\n                    borderBottom: \"2px solid #333\",\n                    padding: \"8px\",\n                    position: \"sticky\",\n                    left: 0,\n                    background: \"#f5f5f5\",\n                    color: \"#111\",\n                    zIndex: 10,\n                  }}\n                >\n                  Coach Name\n                </th>\n                <th\n                  style={{\n                    textAlign: \"left\",\n                    borderBottom: \"2px solid #333\",\n                    padding: \"8px\",\n                    background: \"#f5f5f5\",\n                    color: \"#111\",\n                  }}\n                >\n                  Center\n                </th>\n                {sortedDates.map((date) => (\n                  <th\n                    key={date}\n                    style={{\n                      borderBottom: \"2px solid #333\",\n                      padding: \"8px\",\n                      textAlign: \"center\",\n                      background: \"#f5f5f5\",\n                      color: \"#111\",\n                      minWidth: \"80px\",\n                    }}\n                  >\n                    {date}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {coachesData.map((coach) => (\n                <tr key={coach.id}>\n                  <td\n                    style={{\n                      padding: \"8px\",\n                      borderBottom: \"1px solid #ddd\",\n                      position: \"sticky\",\n                      left: 0,\n                      background: \"#fff\",\n                      zIndex: 5,\n                    }}\n                  >\n                    <button\n                      onClick={() => onCoachClick && onCoachClick(coach.id)}\n                      style={{\n                        background: \"none\",\n                        border: \"none\",\n                        padding: 0,\n                        margin: 0,\n                        color: \"#2a7\",\n                        textDecoration: \"underline\",\n                        cursor: \"pointer\",\n                      }}\n                    >\n                      {coach.name}\n                    </button>\n                  </td>\n                  <td\n                    style={{\n                      padding: \"8px\",\n                      borderBottom: \"1px solid #ddd\",\n                      background: \"#fff\",\n                    }}\n                  >\n                    {coach.center}\n                  </td>\n                  {sortedDates.map((date) => {\n                    const mark = coach.dates[date] || \"-\";\n                    const bg =\n                      mark === \"✓\"\n                        ? \"#d4f4dd\"\n                        : mark === \"✗\"\n                        ? \"#ffd4d4\"\n                        : \"transparent\";\n                    return (\n                      <td\n                        key={date}\n                        style={{\n                          padding: \"8px\",\n                          textAlign: \"center\",\n                          borderBottom: \"1px solid #ddd\",\n                          background: bg,\n                        }}\n                      >\n                        {mark}\n                      </td>\n                    );\n                  })}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n\n      {!loading &&\n        !error &&\n        coachesData.length === 0 &&\n        records.length === 0 && (\n          <div style={{ color: \"#666\", marginTop: 12 }}>\n            No attendance records found for the selected criteria.\n          </div>\n        )}\n\n      {!loading && centerId && coachesForCenter.length > 0 && (\n        <div style={{ marginTop: 24 }}>\n          <h4>Coaches in Selected Center</h4>\n          <ul>\n            {coachesForCenter.map((coach) => (\n              <li key={coach.id}>\n                <button\n                  onClick={() => onCoachClick && onCoachClick(coach.id)}\n                  style={{\n                    background: \"none\",\n                    border: \"none\",\n                    padding: 0,\n                    margin: 0,\n                    color: \"#2a7\",\n                    textDecoration: \"underline\",\n                    cursor: \"pointer\",\n                  }}\n                >\n                  {coach.name}\n                </button>\n                {\" - \"}\n                {coach.center?.name || \"No center\"}\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["CoachAttendanceHistory","_ref","token","onCoachClick","centers","setCenters","useState","coaches","setCoaches","centerId","setCenterId","start","setStart","end","setEnd","records","setRecords","loading","setLoading","error","setError","useEffect","async","res","fetch","concat","API_BASE_URL","headers","Authorization","data","json","sort","a","b","name","localeCompare","fetchCenters","fetchCoaches","groupedData","allDates","Set","forEach","record","_record$coach","_record$coach2","_record$coach3","_record$coach3$center","coachId","coach","id","coachName","centerName","center","date","dates","present","add","sortedDates","Array","from","coachesData","Object","values","coachesForCenter","filter","c","_c$center","Number","_jsxs","children","_jsx","style","display","gap","flexWrap","marginBottom","value","onChange","e","target","map","type","onClick","s","Date","Math","ceil","daysBetween","ok","Error","err","message","disabled","padding","minWidth","text","blob","Blob","url","window","URL","createObjectURL","document","createElement","href","download","body","appendChild","click","remove","revokeObjectURL","color","length","overflowX","width","borderCollapse","textAlign","borderBottom","position","left","background","zIndex","border","margin","textDecoration","cursor","mark","bg","marginTop","_coach$center"],"sourceRoot":""}